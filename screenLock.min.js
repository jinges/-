ScreenLock=function(){var a=30,c=height=document.body.offsetWidth,g=30,e=[],b=[],f,h,j,i=[],d=0;this.caculateNinePoint=function(n){var m=[];for(var o=0;o<3;o++){for(var l=0;l<3;l++){var k={x:g+(l*2+1)*a+n*l,y:g+(o*2+1)*a+n*o};m.push(k)}}return m};this.caculateOverPoint=function(p){for(var l=0;l<e.length;l++){var o=e[l];var m=Math.abs(o.x-p.pageX);var n=Math.abs(o.y-p.pageY);var k=Math.sqrt(m*m+n*n);if(k<a){if(b.indexOf(l)<0){b.push(l);break}}}},this.drawLine=function(n){if(b.length>0){j.beginPath();j.strokeStyle=f;j.lineWidth=10;for(var m=0;m<b.length;m++){var l=b[m];j.lineTo(e[l].x,e[l].y)}j.stroke();j.closePath();if(n!=null){var l=b[b.length-1];var k=e[l];j.beginPath();j.moveTo(k.x,k.y);j.lineTo(n.pageX,n.pageY);j.stroke();j.closePath()}}if(d){this.drawPoint();return false}return true};this.drawPoint=function(){for(var l=0;l<e.length;l++){var k=e[l];j.fillStyle="#ccc";j.beginPath();j.arc(k.x,k.y,a,0,Math.PI*2,true);j.closePath();j.fill();j.fillStyle="#fff";j.beginPath();j.arc(k.x,k.y,a-2,0,Math.PI*2,true);j.closePath();j.fill();this.drawSelectPoint(l,k)}};this.drawSelectPoint=function(m,l){if(b.indexOf(m)>=0){for(var n=0,k=b.length;n<k;n++){if(i.length>0&&b[n]!==i[n]*1){f="#f93a3b";d=1}}j.fillStyle=f;j.beginPath();j.arc(l.x,l.y,a,0,Math.PI*2,true);j.closePath();j.fill();j.fillStyle="#fff";j.beginPath();j.arc(l.x,l.y,a-2,0,Math.PI*2,true);j.closePath();j.fill();j.fillStyle=f;j.beginPath();j.arc(l.x,l.y,a-20,0,Math.PI*2,true);j.closePath();j.fill()}};this.setLockNum=function(k){i=k};this.touch=function(l){var k=this;k.init();h.addEventListener("touchstart",function(m){k.caculateOverPoint(m.touches[0])},false);h.addEventListener("touchmove",function(m){m.stopPropagation();var n=m.touches[0];k.caculateOverPoint(n);j.clearRect(0,0,c,height);flag=k.drawLine(n);k.drawPoint();if(!flag){l({error:"error"})}},false);h.addEventListener("touchend",function(m){if(l){l(null,b)}setTimeout(function(){k.init()},500)},false)};this.init=function(){h=document.querySelector("#canvas"),j=h.getContext("2d");h.width=c;h.height=height;b=[];f="#92ca02";var k=(c-a*2*3-g*2)/2;e=this.caculateNinePoint(k);this.drawPoint();return this}};var Jiu=new ScreenLock();